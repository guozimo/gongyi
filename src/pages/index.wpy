<template>
<view>
<scroll-view class='page'>
  <!-- åˆ—è¡¨ -->
  <view class='CircleList' wx:for-items="{{DataSource}}" wx:for-index="index" wx:for-item="item" wx:key="id" >
    <!-- å¤´åƒã€æ˜µç§°ã€å†…å®¹ -->
    <view class='body-view'>
      <!-- å¤´åƒ -->
      <view class='left-view'>
        <image class='user-icon' src='{{icon}}'></image>
      </view>
      <view class='right-view' bindtap='TouchDiscuss'>
        <!-- æ˜µç§° -->
        <view class='user-name-view'>
          <label class='user-name'>å®£å¿—å¼º</label>
        </view>
        <!-- å†…å®¹ -->
        <view class='user-content-view'>
          <text class='user-content'>{{content}}</text>
        </view>
        <!-- å›¾ç‰‡ -->
        <view class='photo-view'>
          <view class='photo' wx:for='{{resource}}' style='width:{{photoWidth}}px;height:{{photoWidth}}px'>
            <image bindtap='LookPhoto' data-photUrl='{{item}}' src='{{item}}' style='width:{{photoWidth}}px;height:{{photoWidth}}px'></image>
          </view>
        </view>
        <!-- åœ°ç†ä½ç½® -->
        <!-- <view class='user-address-view'>
          <label>é•¿æ²™å¸‚å¤©å¿ƒåŒºèŠ™è“‰å—è·¯å››æ®µ158å·åœ°ç†ä¿¡æ¯äº§ä¸šå›­æ€»éƒ¨åŸºåœ°Aåº§9æ¥¼</label>
        </view> -->

        <!-- æ—¶é—´ã€åˆ é™¤æŒ‰é’®ã€ç‚¹èµè¯„è®ºæŒ‰é’® -->
        <view class='TDD-view'>
          <label>2018-07-25 10:14:23</label>
          <button bindtap='delete' wx:if='{{item.userName===userName}}'>åˆ é™¤</button>
          <image data-isShow='{{isShow}}'   src='/images/wxdiscuss.png' data-id='discuss'></image>
          <image  src='/images/zan.png' wx:if='{{!isShow&&needZan}}' class='zan_box' @tap='changeStatus'/>
           <image  src='/images/cancel.png' wx:if='{{!isShow&&!needZan}}' class='zan_box' @tap='changeStatus'/>
        </view>

        <!-- ç‚¹èµ -->
        <view class='zan-view'>
          <view class='trigon-view'>
            <image mode='aspectFill' class='trigon' src='/images/trigon.png'></image>
          </view>

          <!-- ç‚¹èµ -->
          <view class='zan-bg-view'>
            <view class='heart'>ğŸ’˜</view>
            <view class='zan-user-view' wx:for='{{zanSource}}'>
              <label bindtap='TouchZanUser' data-name='{{item}}' class='zan-user'>{{item}},</label>
            </view>
          </view>
          <view class='line'></view>
          <!-- è¯„è®º -->
          <!-- <view class='discuss-view'>
            <view class='discuss' wx:for='{{contnet}}'>
              <label bindtap='TouchZanUser' data-name='{{item.firstname}}' class='discuss-user'>{{item.firstname}}ï¼š</label>
              <label class='content'>{{item.content}}</label>
            </view>
          </view> -->
        </view>
      </view>

    </view>
  </view>
</scroll-view>

<!-- è¯„è®ºæŒ‰é’®å¼¹å‡ºæ¡† -->
<view animation="{{animation}}" class='pop-up-box' style='top:{{popTop}}px;width: {{popWidth}}px;'>
</view>
 <view class='active'>
    <image src='/images/find.gif' class='active_img' @tap="gotoweb"/>
   </view>
   </view>
</template>

<script>
  import wepy from 'wepy'
  export default class Index extends wepy.page {
    onShareAppMessage() {
      return {
        title: 'ä¸ºå…¬å…¬ç›Šæ˜¯ä½ æˆ‘çš„å®¶å›­!',
        imageUrl: 'http://39.105.91.188/static/image/fm.jpg',
        path: `/pages/index`
      }
    }
    config = {
      navigationBarTitleText: 'åœˆå­'
    }
    components = {
    }

    data = {
      openId: wx.getStorageSync('openId') || '',
      DataSource: [{'userName': 'å®£å¿—å¼º'}, {'userName': 'å¼ å¼º'}, {'userName': 'å¼ å¼º'}, {'userName': 'å¼ å¼º'}, {'userName': 'ä¸œå­'}],
      icon: 'https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=3175633703,3855171020&fm=27&gp=0.jpg',
      content: 'æˆ‘å¤§å­¦æ¯•ä¸šåˆ°ä¸€å®¶é›†å›¢å…¬å¸çš„åŠå…¬å®¤å½“æ–‡å‘˜ã€‚åŠå…¬å®¤ä¸»ä»»æœ‰ä¸€ç‰¹é•¿ï¼Œå³æ–‡ç« å†™å¾—å¥½ï¼Œå¾ˆæœ‰æ€æƒ³ï¼Œå…¬å¸è‘£äº‹é•¿å¾ˆå™¨é‡ä»–ï¼Œè‘£äº‹é•¿çš„è®²è¯ç¨¿å’Œä¼ä¸šçš„å¹´ç»ˆæ€»ç»“ç­‰ä¸€ç³»åˆ—é‡å¤§æ–‡ç« éƒ½æ˜¯å‡ºè‡ªä»–çš„æ‰‹ç¬”ã€‚',
      resource: ['http://img2.imgtn.bdimg.com/it/u=2118739199,3378602431&fm=27&gp=0.jpg',
        'http://img0.imgtn.bdimg.com/it/u=2277942808,1417432970&fm=27&gp=0.jpg',
        'http://img5.imgtn.bdimg.com/it/u=1504812505,3480403568&fm=27&gp=0.jpg',
        'http://img4.imgtn.bdimg.com/it/u=3456219059,4251129897&fm=27&gp=0.jpg',
        'http://img3.imgtn.bdimg.com/it/u=3912316188,1981132393&fm=27&gp=0.jpg'
      ],
      zanSource: ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'æ‰¾é’±', 'å­™ä¿ª', 'ç‹å®'],
      contnet: [{
        'firstname': 'å¼ ä¸‰',
        'content': 'ä½ å¥½æ¼‚äº®å‘€ï¼ï¼'
      },
      {
        'firstname': 'æå››',
        'content': 'çº³å°¼ï¼ï¼'
      },
      {
        'firstname': 'ç‹äº”',
        'content': 'é¬¼æ‰¯å’§'
      },
      {
        'firstname': 'ç‹å®',
        'content': 'æ˜¨æ™š11ç‚¹å·¦å³ï¼Œä¸€åˆ™éƒ‘çˆ½èƒ¡å½¦æ–Œç–‘ä¼¼å¤åˆçš„æ¶ˆæ¯åˆ·çˆ†å„å¤§è®ºå›ï¼Œå¾®åšåœ¨æ·±å¤œ11ç‚¹çƒ­åº¦é«˜è¾¾200ä¸‡ç›´æ¥çˆ†æ‰ï¼Œä¸­å›½æ„éš¾å¿˜åˆå¼€å§‹äº†ï¼ï¼ï¼'
      }
      ],
      photoWidth: wx.getSystemInfoSync().windowWidth / 5,
      popTop: 0, // å¼¹å‡ºç‚¹èµè¯„è®ºæ¡†çš„ä½ç½®
      popWidth: 0, // å¼¹å‡ºæ¡†å®½åº¦
      isShow: true, // åˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºå¼¹å‡ºæ¡†ï¼Œ
      needZan: true,
      userName: wx.getStorageSync('userInfo').nickName || ''

    }

    computed = {
    }

    methods = {
      gotoweb() {
        wepy.navigateTo({
          url: '/pages/active/active'
        })
      },
      changeStatus() {
      // åˆ‡æ¢çŠ¶æ€
        this.needZan = !this.needZan
        this.isShow = true
      },
       // ç‚¹å‡»å›¾ç‰‡è¿›è¡Œå¤§å›¾æŸ¥çœ‹
      LookPhoto: function(e) {
        wx.previewImage({
          current: e.currentTarget.dataset.photurl,
          urls: this.resource
        })
      },

  // ç‚¹å‡»ç‚¹èµçš„äºº
      TouchZanUser: function(e) {
        wx.showModal({
          title: e.currentTarget.dataset.name,
          showCancel: false
        })
      },

  // åˆ é™¤æœ‹å‹åœˆ
      delete: function() {
        wx.showToast({
          title: 'åˆ é™¤æˆåŠŸ'
        })
      },

  // ç‚¹å‡»äº†ç‚¹èµè¯„è®º
      TouchDiscuss: function(e) {
        console.log(e, 'e======')
        if (e.target.dataset.id !== 'discuss') {
          this.isShow = true
        } else {
          this.isShow = !this.isShow
        }
      }
    }

    events = {
    }

    onLoad() {
    }
  }
</script>

<style lang="less">
/* pages/CircleFriends/CircleFriends.wxss */
page{
  background: whitesmoke;
}
  .active {
  width:116rpx;
  height:116rpx;
  position:fixed;
  bottom:50rpx;
  right:20rpx;
  .active_img{
    width:100%;
    height:100%;
  }
  }
.page{
  width: 100%;
  /* overflow-x: hidden */
}

/* åˆ—è¡¨ */
.CircleList{
  background: white;
  margin-bottom: 1px;
  border-bottom: 1px solid whitesmoke;
  border-top: 1px solid whitesmoke;
}

.body-view{
  display: flex;
}

.left-view{
  width: 150rpx;
  /* background: rebeccapurple; */
}

.right-view{
  /* background: red; */
}

/* å¤´åƒ */
.user-icon{
  /* display: flex; */
  width:100rpx;
  height: 100rpx;
  margin-left: 20rpx;
  margin-top: 30rpx;
  margin-right: 20rpx;
  border-radius:50%
}

/* æ˜µç§° */
.user-name{
  display: flex;
  height: 50rpx;
  line-height: 50rpx;
  font-size: 18px;
  color: rgb(88, 103, 138);
  margin-top: 30rpx;
  margin-left: 10rpx;
}

/* å†…å®¹ */
.user-content{
  display: flex;
  font-size: 18px;
  line-height: 50rpx;
  margin-left: 10rpx;
}

/* å›¾ç‰‡ */
.photo-view{
  background: rebeccapurple;
  margin-left: 10rpx;
  margin-bottom: 20rpx;
}
.photo{
  background: rgb(255, 166, 0);  
  float: left;
  margin-right: 10rpx;
  margin-top: 10rpx;
}

/* åœ°ç†ä½ç½® */
.user-address-view{
  display: flex;
  margin-top: 20rpx;
  width: 100%;
}
.user-address-view label{
  font-size: 12px;
  margin: 10rpx;
}

/* æ—¶é—´ã€åˆ é™¤ã€ç‚¹èµè¯„è®º */
.TDD-view{
  width: 100%;
  height: 60rpx;
  display: flex;
  align-items: center;
  background: white;
  position:relative;
   .zan_box{
    width:160rpx;
    height:68rpx;
    display:block;
    position:absolute;
    top:0;
    right:55rpx;
  }
}
.TDD-view label{
  font-size: 13px;
  margin-left: 10rpx;
}
.TDD-view button{
  font-size: 13px;
  margin-left: 20rpx;
  color: black;
  background: white;
}
.TDD-view button::after{
  border: white;
}
.TDD-view image{
  width: 50rpx;
  height: 40rpx;
  margin-right: 20rpx;
}

/* ç‚¹èµ */
.zan-view {
  width: 100%;
  background: white;
  margin-bottom: 20rpx;
}
.trigon-view{
  /* height: 20rpx; */
  margin-bottom: -15rpx;
}
.trigon{
  display: flex;
  width: 40rpx;
  height: 20rpx;
  margin-top: 10rpx;
  margin-left: 10rpx;
}
.zan-bg-view{
  display:inline-block;
  width: 97%;
  background: rgb(235, 235, 235);
  margin-right: 20rpx;
  margin-bottom: -11rpx;
  border-top-left-radius: 7rpx;
  border-top-right-radius: 7rpx;
  position:relative;
  .heart{
   display: flex;
  float: left;
  margin-left: 10rpx;
  margin-top:-5rpx;
   }
}
.zan-user-view{
  display: flex;
  float: left;
  height: 40rpx;
  margin-left: 10rpx;
  /* margin-top: 5rpx; */
  align-content: center;
}
.zan-user{
  font-size: 12px;
  line-height: 40rpx;
  height: 40rpx;
  color: rgb(88, 103, 138);
}

.line{
  width: 97%;
  height: 1px;
  background: white;
}

/* è¯„è®º */
.discuss-view{
  background: white;
  width: 97%;
}

.discuss{
  background: rgb(235, 235, 235);
  line-height: 35rpx;
}

.discuss label{
  font-size: 12px;
}

.discuss-user{
  color: rgb(88, 103, 138);
  margin-left: 10rpx;
}

.content{
  margin-left: 10rpx;
}

/* å¼¹å‡ºæ¡† */
.pop-up-box{
  position: absolute;
  height: 60rpx;
  border-radius: 10rpx;
  right: 90rpx;
  background: rgba(0, 0, 0, 0.7);
 
}
</style>
